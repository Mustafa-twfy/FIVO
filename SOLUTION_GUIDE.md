# دليل حل مشكلة "سائق تجريبي"

## المشكلة
عند تسجيل الدخول بحساب سائق، تظهر شاشة "سائق تجريبي" مع رسالة "يرجى تحويل حالتك إلى متوفر لاستقبال طلبات جديدة" بدلاً من عرض بيانات السائق الحقيقي.

## أسباب المشكلة

### 1. **البيانات الافتراضية في الكود**
- الكود يستخدم بيانات افتراضية عندما لا يتم العثور على السائق في قاعدة البيانات
- تم إصلاح هذا في `DriverDashboardScreen.js`

### 2. **عدم استخدام AuthContext**
- الكود لا يستخدم البيانات المخزنة في `AuthContext` بشكل صحيح
- تم إصلاح هذا لاستخدام البيانات من `AuthContext` أولاً

### 3. **مشكلة في قاعدة البيانات**
- قد تكون البيانات غير موجودة أو غير صحيحة في قاعدة البيانات

## الحلول المطبقة

### 1. **إصلاح منطق تهيئة السائق**
```javascript
// في DriverDashboardScreen.js
const { logout, user, userType } = useAuth();

// التحقق من نوع المستخدم أولاً
if (userType !== 'driver') {
  // تسجيل الخروج
}

// استخدام البيانات من AuthContext
if (user && user.id) {
  setDriverId(user.id);
  setDriverInfo(user);
  setIsOnline(user.is_active || false);
  await loadDriverData(user.id);
}
```

### 2. **إزالة البيانات الافتراضية**
- تم إزالة جميع البيانات الافتراضية مثل "سائق تجريبي"
- الآن إذا لم يتم العثور على السائق، سيتم تسجيل الخروج

### 3. **تحسين عملية تسجيل الدخول**
- إضافة المزيد من التفاصيل في console.log لتتبع المشكلة
- جلب جميع السائقين للتحقق من البيانات

## خطوات الاختبار

### 1. **تأكد من وجود السائق في قاعدة البيانات**
```sql
SELECT * FROM drivers WHERE email = 'your-email@example.com';
```

### 2. **تأكد من حالة السائق**
```sql
SELECT email, name, status, is_active, is_suspended FROM drivers;
```

### 3. **اختبار تسجيل الدخول**
استخدم هذه البيانات للتجربة:
- **البريد الإلكتروني**: `driver1@tawseel.com`
- **كلمة المرور**: `password123`

### 4. **فحص console logs**
افتح Developer Tools وابحث عن:
- `=== بداية تهيئة بيانات السائق ===`
- `AuthContext user:`
- `AuthContext userType:`

## البيانات التجريبية المتاحة

### السائقين:
1. **أحمد محمد**
   - البريد: `driver1@tawseel.com`
   - كلمة المرور: `password123`
   - الحالة: `approved`
   - نشط: `true`

2. **محمد علي**
   - البريد: `driver2@tawseel.com`
   - كلمة المرور: `password123`
   - الحالة: `approved`
   - نشط: `true`

3. **سائق تجريبي**
   - البريد: `test@driver.com`
   - كلمة المرور: `123456`
   - الحالة: `approved`
   - نشط: `false`

## إذا استمرت المشكلة

### 1. **تحقق من console logs**
ابحث عن رسائل الخطأ في Developer Tools

### 2. **تحقق من قاعدة البيانات**
تأكد من أن الجداول موجودة والبيانات صحيحة

### 3. **إعادة تشغيل التطبيق**
```bash
npx expo start --clear
```

### 4. **مسح التخزين المؤقت**
```bash
npx expo r -c
```

## ملاحظات مهمة

- تأكد من أن السائق له `status = 'approved'`
- تأكد من أن السائق ليس `is_suspended = true`
- تأكد من أن `is_active` صحيح إذا كنت تريد أن يكون متوفراً
- تأكد من أن `debt_points` أقل من الحد الأقصى (20 نقطة افتراضياً) 