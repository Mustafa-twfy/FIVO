# إعداد نظام النقطة الحمراء للإشعارات

## الميزة المضافة
تم إضافة نظام النقطة الحمراء (Badge) للإشعارات في جميع شاشات التطبيق. عندما يصل إشعار جديد، تظهر نقطة حمراء فوق زر الإشعارات مع عدد الإشعارات غير المقروءة.

## الشاشات المحدثة

### 1. شاشة لوحة تحكم المتجر (StoreDashboardScreen)
- إضافة عداد الإشعارات غير المقروءة
- عرض النقطة الحمراء فوق زر الإشعارات

### 2. شاشة لوحة تحكم السائق (DriverDashboardScreen)
- إضافة زر الإشعارات في الهيدر
- عرض النقطة الحمراء مع عدد الإشعارات غير المقروءة

### 3. شاشة لوحة تحكم المدير (AdminDashboardScreen)
- إضافة عداد الإشعارات غير المقروءة لجميع السائقين والمتاجر
- عرض النقطة الحمراء فوق زر "إشعار عام"

### 4. شاشة قائمة المتاجر (StoresScreen)
- إضافة عداد الإشعارات غير المقروءة لكل متجر
- عرض النقطة الحمراء فوق زر الإشعارات لكل متجر

### 5. شاشة قائمة السائقين (DriversScreen)
- إضافة عداد الإشعارات غير المقروءة لكل سائق
- عرض النقطة الحمراء فوق زر الإشعارات لكل سائق

### 6. شاشة إشعارات السائق (DriverNotificationsScreen)
- تحديث حالة الإشعارات إلى "مقروءة" عند فتح الشاشة

### 7. شاشة إشعارات المتجر (StoreNotificationsScreen)
- تحديث حالة الإشعارات إلى "مقروءة" عند فتح الشاشة

## التحديثات في قاعدة البيانات

### الجداول المحدثة:
1. **جدول notifications**
   - إضافة حقل `is_read` (BOOLEAN, DEFAULT FALSE)

2. **جدول store_notifications**
   - إضافة حقل `is_read` (BOOLEAN, DEFAULT FALSE)

### الفهارس المضافة:
- `idx_notifications_driver_read` على `notifications(driver_id, is_read)`
- `idx_store_notifications_store_read` على `store_notifications(store_id, is_read)`

## كيفية التطبيق

### 1. تشغيل SQL Script
```bash
# تشغيل الملف في Supabase SQL Editor
add_notification_is_read_field.sql
```

### 2. تحديث التطبيق
تم تحديث جميع الملفات المطلوبة:
- `screens/StoreDashboardScreen.js`
- `screens/DriverDashboardScreen.js`
- `screens/AdminDashboardScreen.js`
- `screens/StoresScreen.js`
- `screens/DriversScreen.js`
- `screens/DriverNotificationsScreen.js`
- `screens/StoreNotificationsScreen.js`

## الميزات المضافة

### 1. عداد الإشعارات غير المقروءة
- يتم جلب عدد الإشعارات غير المقروءة في الوقت الفعلي
- يتم تحديث العداد عند استلام إشعارات جديدة

### 2. النقطة الحمراء (Badge)
- تظهر فوق زر الإشعارات
- تعرض عدد الإشعارات غير المقروءة
- تختفي عند عدم وجود إشعارات غير مقروءة

### 3. تحديث حالة القراءة
- عند فتح شاشة الإشعارات، يتم تحديث جميع الإشعارات إلى "مقروءة"
- يتم إزالة النقطة الحمراء تلقائياً

### 4. تصميم متجاوب
- النقطة الحمراء تتكيف مع حجم الشاشة
- الألوان متوافقة مع نظام الألوان العام للتطبيق

## ملاحظات مهمة

1. **الأداء**: تم إضافة فهارس لتحسين أداء استعلامات الإشعارات
2. **التوافق**: لا تؤثر التحديثات على الوظائف الموجودة
3. **الأمان**: يتم التحقق من صحة البيانات قبل التحديث
4. **التجربة**: تحسين تجربة المستخدم من خلال إظهار حالة الإشعارات بوضوح

## اختبار الميزة

1. إرسال إشعار جديد من لوحة تحكم المدير
2. التحقق من ظهور النقطة الحمراء في الشاشات المعنية
3. فتح شاشة الإشعارات والتحقق من اختفاء النقطة الحمراء
4. التأكد من تحديث العداد عند استلام إشعارات جديدة 