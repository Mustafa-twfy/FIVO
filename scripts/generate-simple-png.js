#!/usr/bin/env node

const fs = require('fs');
const path = require('path');

// Ø¥Ù†Ø´Ø§Ø¡ PNG Ø¨Ø³ÙŠØ· Ø¬Ø¯Ø§Ù‹ ÙˆØµØ­ÙŠØ­ (Ø£ØµØºØ± Ù…Ù„Ù PNG Ù…Ù…ÙƒÙ†)
function createMinimalValidPNG() {
  // Ø£ØµØºØ± PNG ØµØ§Ù„Ø­ (1x1 pixel Ø£Ø¨ÙŠØ¶)
  const minimalPNG = Buffer.from([
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG signature
    0x00, 0x00, 0x00, 0x0D, // IHDR chunk length
    0x49, 0x48, 0x44, 0x52, // IHDR
    0x00, 0x00, 0x00, 0x01, // width = 1
    0x00, 0x00, 0x00, 0x01, // height = 1
    0x08, 0x06, 0x00, 0x00, 0x00, // bit depth = 8, color type = 6 (RGBA), compression = 0, filter = 0, interlace = 0
    0x1F, 0x15, 0xC4, 0x89, // CRC
    0x00, 0x00, 0x00, 0x0A, // IDAT chunk length
    0x49, 0x44, 0x41, 0x54, // IDAT
    0x78, 0x9C, 0x62, 0x00, 0x02, 0x00, 0x00, 0x05, 0x00, 0x01, // compressed data
    0x0D, 0x0A, 0x2D, 0xB4, // CRC
    0x00, 0x00, 0x00, 0x00, // IEND chunk length
    0x49, 0x45, 0x4E, 0x44, // IEND
    0xAE, 0x42, 0x60, 0x82  // CRC
  ]);

  const iconPath = path.join(__dirname, '../assets/icon.png');
  const adaptiveIconPath = path.join(__dirname, '../assets/adaptive-icon.png');
  
  fs.writeFileSync(iconPath, minimalPNG);
  fs.writeFileSync(adaptiveIconPath, minimalPNG);
  
  console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ PNG ØµØ§Ù„Ø­ Ø£Ø³Ø§Ø³ÙŠ (1x1 pixel)');
  console.log(`ğŸ“ Ø­ÙÙØ¸ ÙÙŠ: ${iconPath}`);
  console.log(`ğŸ“ ÙˆØ£ÙŠØ¶Ø§Ù‹ ÙÙŠ: ${adaptiveIconPath}`);
  console.log(`ğŸ“ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù: ${minimalPNG.length} Ø¨Ø§ÙŠØª`);
  
  return true;
}

// Ø¥Ù†Ø´Ø§Ø¡ PNG Ø£Ø®Ø¶Ø± Ø¨Ø³ÙŠØ· 48x48
function createGreenIcon() {
  // PNG Ø£Ø®Ø¶Ø± 48x48 (Ù…ØµÙ†ÙˆØ¹ ÙŠØ¯ÙˆÙŠØ§Ù‹)
  const greenPNG = Buffer.from([
    // PNG Signature
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A,
    
    // IHDR Chunk
    0x00, 0x00, 0x00, 0x0D, // Length: 13 bytes
    0x49, 0x48, 0x44, 0x52, // Type: IHDR
    0x00, 0x00, 0x00, 0x30, // Width: 48
    0x00, 0x00, 0x00, 0x30, // Height: 48
    0x08, 0x02, 0x00, 0x00, 0x00, // Bit depth: 8, Color type: 2 (RGB), Compression: 0, Filter: 0, Interlace: 0
    0x91, 0x5D, 0x5F, 0x64, // CRC
    
    // IDAT Chunk (compressed green color data)
    0x00, 0x00, 0x00, 0x1F, // Length: 31 bytes
    0x49, 0x44, 0x41, 0x54, // Type: IDAT
    0x78, 0x9C, 0x62, 0x60, 0x60, 0xF8, 0x0F, 0x00, 0x01, 0x01, 0x01, 0xFF, 0x02, 0x00, 0x00, 0xFF, 0xFF, 0x03, 0x00, 0x06, 0x00, 0x05, 0x02, 0x00, 0x0E, 0xDD, 0xA0, 0x52, 0x00, 0x00, 0x00,
    0xFE, 0x23, 0x36, 0x81, // CRC
    
    // IEND Chunk
    0x00, 0x00, 0x00, 0x00, // Length: 0
    0x49, 0x45, 0x4E, 0x44, // Type: IEND
    0xAE, 0x42, 0x60, 0x82  // CRC
  ]);

  return greenPNG;
}

console.log('ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø© PNG ØµØ­ÙŠØ­Ø©...');

try {
  // Ø¬Ø±Ø¨ Ø§Ù„Ù€ PNG Ø§Ù„Ø¨Ø³ÙŠØ· Ø£ÙˆÙ„Ø§Ù‹
  createMinimalValidPNG();
  console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ PNG Ø¨Ù†Ø¬Ø§Ø­');
} catch (error) {
  console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ PNG:', error.message);
  process.exit(1);
}
